# Vim 使用技巧

> 希望自己能够再坚持使用 vim 一年

# 宏

## 技巧65：宏的录制与执行

1. 许多重复性工作可以录制成一个宏然后重复

2. `q{register}` 既是录制也是停止按钮，register 指的是一个保存宏的寄存器

3. `@{register}` 执行指定寄存器的内容，同时也可以使用 `@@` 来重复最近调用过的宏

4. 存在串行和并行两种方式

## 技巧66：规范光标位置、直达目标以及终止宏

1. 在录制一个宏时，要确保每个每条命令都能被重复执行

2. 在开始录制一个宏时，应该规范光标位置，比如行首或者一个查找匹配项

3. 在使用宏时，禁止使用鼠标（ 我觉得这一点肯定不会出现的）

4. 动作命令失败时候，宏将终止执行空，形如行末按下 `j` 就会失败

## 技巧67：加次数回放宏

1. 回放宏可以解决部分点范式的缺点

2. 可以配合回放宏与点范式结合使用

## 技巧68：在连续的文本上重复修改

1. `f{char}` 对于宏来说存在一个安全捕获机制，能够在找不到的情况下报错同时终止宏

2. `{n}q{register}` 串行执行宏

3. `:normal @{register}` 并行执行，相互独立调用

## 技巧69：给宏追加命令

1. `q{register}` 当 register 大写字母时，其会附加内容到小写字母的寄存器上去

2. 但上述方式只能在宏的末尾添加内容，无法在中间进行修改

## 技巧70：在一组文件中执行宏

1. `argdo normal {cmd}` 可以对文件进行宏操作，这种为并行

2. `{n}@{register} :next` 是一种串行的方式

3. `wall` 保存所有文件改动

4. 串行和并行宏两种各有各的优缺点

## 技巧71：  用迭代求值的方式给列表编号

1. `let i = {val}` let 用于 vim 脚本中创建变量

2. `echo` 用于输出变量的值

3. 配合插入模式 `Ctrl - o + = + CR` 计算变量值，然后通过递增等

## 技巧72：编辑宏的内容

1. `~` 操作符切换光标下的字母大小写同时将光标移动到后边，`vU` 会将光标处的字母大写

2.  复制粘贴所用的寄存器与宏的相同，所以可以通过复制或剪切的方式实现对宏的修改

3. 比如我要对 `"q` 寄存器做修改，只需要将 `"q` 内容复制粘贴出来改完后再保存到寄存器中

# 模式

## 技巧73：调整查找模式的大小写敏感

1. `:set ignorecase` 的设置会让 vim 不区分大小写

2. `\c` 和 `\C`，前者忽略大小写，后者区分大小写

## 技巧74：按正则表达式查找时，使用 `\v` 模式开关

1. `very magic` 模式比 `magic` 更好记忆，可读性更强，使用时前面带上 `\v` 即可

2. `\x` 表示十六进制字符类

## 技巧75：按原义查找文本时，使用 `\V` 原义开关

1. `\V` 会激活 very nomagic 搜索模式

2. 可以用来查找原义文本

## 技巧76：使用圆括号捕获子匹配

1. `()` 子匹配可以通过 `\{n}` 来引用

## 技巧77：界定单词的边界

1. `\v<the>` 匹配特定界线的单词

2. ` `

> PS: 匹配这张看的想睡觉😴，暂时先跳过

## 技巧80：结识查找命令

1. `wrapscan` 模式能够让从当前位置开始循环查找

2. `/<CR>` 正向跳转到下一个匹配，`?<CR>` 反向跳转到上一个匹配项

## 技巧81：高亮查找匹配

1. `set hlsearch` 设置高亮匹配项

2. `:nohlsearch` 比彻底禁用该功能优雅，新的查找命令执行时才会启用高亮

3. `nnoremap <silent> <C-l> :<C-u>noh<CR><C-l>` 重新做映射使得刷新屏幕同时暂时取消高亮搜索

## 技巧82：在执行查找前预览第一处匹配

1. `incserach` 可以在查找域查找输入的文本同时预览第一处匹配

2. 在输入部分文字匹配之后可以通过 `<C-r><C-w>` 来把光标下的单词补全，此场景比较适合查找单词而非查找模式

## 技巧83：将光标偏移到查找匹配的结尾

1. `/{keywords}/e` 会查找到匹配的同时将光标置于匹配结尾

## 技巧84： 对完整的查找匹配进行操作

1. `gu{motion}` 将指定文本转换为大写，`gn` 查找下一处并进入可视模式选取匹配项，`gN` 与 `gn` 相反

## 技巧85：利用查找历史，迭代完成复杂的模式

1. `q/` 进入模式的命令行窗口，能够对过去的命令进行查看与修改

2. `<Ctrl-r>{register}` 能够在插入模式中粘贴 register 中的内容

3. 对于每一次匹配来说，引号所括的文本已经被赋给了 `\1` 了

## 技巧86：统计当前模式的匹配个数

1. `:substitute` 统计个数：`:%s///gn` 其中 n 会抑制正常的替换动作，一二 `/` 界定了匹配域，二三界定了替换域

2. `:vimgrep` 统计个数，`:vimgrep //g %`

	其中会把当前文件所有匹配项放进 `quickfix` 中，其中 `%` 指定了全本范围，当然他也可以跨文件进行查找。

	`:cn[ext]` 和 `:cp[revious]` 分别正向和反向匹配跳转

## 技巧87：查找当前高亮选区中的文本

> 这个地方还不是很懂中


