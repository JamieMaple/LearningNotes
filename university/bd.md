# API GATEWAY

## 背景

People 所有业务都在一个服务下面，业务没有分层，API 和 service 都在一个工程中，所有数据库在一个 MySQL 中

### 优缺点

1. 快速开发，共用代码，代码利用率高

2. 单个业务维护成本太大，相互关系较复杂

3. 任何一个业务挂了，可能影响到后续各种业务

## 改进

### 主要思路

> 拆分 + 微服务

### 优缺点

1. 耦合性降低，相互影响减少

2. 拆分数据库表，最小依赖集

3. 需要单独维护 django 环境和相关配置

4. 早起头条研发有使用

## 改进 v3.0

### 背景

基于上一版改进需要单独维护自己的环境与配套的 nginx 配置，存在一些通用的功能，比如 `session`、`csrf` 防范、以及用户认证

### 设计思路

1. 提供 API Platform 平台以供可视化交互

2. 实现 BusinessService 服务

3. 内部通信使用 `thirf` 协议，性能较 `http` 强

### 目标

1. 提供平台，能够通过平台配置接入业务 API

2. 提供组件，以组件的形式提供组件

3. 解耦逻辑，微服务的形式使得业务不再相互影响

4. 更加通用化，能够在将来支持更多的产品

### 流程

1. 通过前端传过来的 http 报文传递到后端

2. 后端对报文进行简单处理

3. 远程请求 RPC、Redis、数据库访问等抽象成的 service

4. 最后生成响应返回给前端

5. 以上包括了 API 以及各类静态资源

> Golang 以及微服务架构在不断地扩大影响力

### 定位

1. API gateway 是统一的接入层，功能上介于 LB 与业务之间，维护通用功能

2. 统一管理 API 

3. 较强的可视化 （目前没有）

